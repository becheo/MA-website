<title>TUB-Prüfstand - Testseite</title>
{% extends 'layout.html' %} {% block body %}


<br>
<br>

<div class="table-responsive">
  <table class="table">
    <thead class="thead-dark">
      <tr>
        <th></th>
        <th>ID</th>
        <th>Hochgeladene Datei</th>
        <th>Datum</th>
        <th>Status</th>
        <th>Aktion</th>
      </tr>
    </thead>
    <tbody>
      <tr class="accordion-toggle collapsed" id="accordion1" data-toggle="collapse" data-parent="#accordion1"
        href="#collapseOne">
        <td class="expand-button"></td>
        <td>Eins</td>
        <td>Zwei</td>
        <td>Drei</td>
        <td>Vier</td>
        <td>Fünf</td>
      </tr>

      <tr class="hide-table-padding">
        <!-- <td></td> -->
        <td colspan="6">
          <div id="collapseOne" class="collapse in p-3">
            <!-- <div class="row"> -->
            <!-- <div class="col-2"> -->
            Text
            <!-- </div> -->
            <!-- <div class="col-6">value 1</div> -->
            <!-- </div> -->
          </div>
        </td>
      </tr>
      {% for file in files %}
      <tr class="accordion-toggle collapsed" id="accordion2" data-toggle="collapse" data-parent="#accordion2"
        href="#collapse{{file.index}}">
        <td class="expand-button"></td>
        <td>{{file.id}}</td>
        <td>{{file.name}}</td>
        <td>{{file.upload_date}}</td>
        <td>Status, Ausgefuehrt am ...</td>
        <td>
          <form action="{{url_for('start_measurement', id=file.id)}}" method="POST">
            <input type="hidden" name="_method" value="Messung starten" />
            <input type="submit" value="Messung starten" class="btn btn-primary" />
          </form>
        </td>
      </tr>

      <tr class="hide-table-padding">
        <!-- <td></td> -->
        <td colspan="3">
          <div id="collapse{{file.index}}" class="collapse in p-3">
            <div id="plot{{file.index}}" style="width:400px;height:250px;"></div>
          </div>
        </td>
        <td colspan="2">
          <div id="collapse{{file.index}}" class="collapse in p-3">
            <div id="plot_results{{file.index}}" style="width:400px;height:250px;"></div>
          </div>
        </td>
        <td colspan="1">
          <div id="collapse{{file.index}}" class="collapse in p-3">

            <form action="{{url_for('delete_entry', id=file.id)}}" method="POST">
              <input type="hidden" name="_method" value="Eintrag Löschen" />
              <input type="submit" value="Eintrag Löschen" class="btn btn-danger" />
            </form>
        </td>
      </tr>
      <!-- <tr class="hide-table-padding">
        <td colspan="2">
          <div id="collapse{{file.index}}" class="collapse in p-3">
            <div id="plot_results{{file.index}}" style="width:400px;height:250px;"></div>
          </div>
        </td>
      </tr> -->
      {% endfor %}

    </tbody>
    <tr style="border-bottom: 10pt solid black; "></tr>

  </table>
</div>

<br>
<br>
<br>
<br>

<!-- Script -->
<script>
  {% for file in files %}
  plot = document.getElementById('plot{{file.index}}');

  var layout = {
    title: 'Spannungsvorgabe',
    xaxis: {
      title: 'Zeit in s'
    },
    yaxis: {
      title: 'Spannung in V',
      showgrid: true
    }
  }

  Plotly.newPlot(plot, [{
    x: {{ file.xdata }},
    y: {{ file.ydata }},
}], layout, {
    margin: { t: 0 }
  });

  plot_results = document.getElementById('plot_results{{file.index}}');

  var layout_results = {
    title: 'Motorspannung',
    xaxis: {
      title: 'Zeit in s'
    },
    yaxis: {
      title: 'Spannung in V',
      showgrid: true
    }
  }

  Plotly.newPlot(plot_results, [{
    x: {{ file.xdata_results }},
    y: {{ file.ydata_results }},
}], layout_results, {
    margin: { t: 0 }
  });
  {% endfor %}
</script>

{% endblock %}